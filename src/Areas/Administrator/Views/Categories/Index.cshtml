@model DataLayer.ViewModels.PagerViewModel.PagerViewModels<DataLayer.Models.Category>
@using MvcPager
@{
    ViewBag.Title = "مدیریت دسته بندی ها";
    Layout = "~/Areas/Administrator/Views/Shared/_Layout.cshtml";
}
<div class="ibox-content">
    <form method="get" action="/Administrator/Categories/Index" class="form-inline mb-3">
        <input type="text" name="search" value="@ViewBag.Search" class="form-control"
               placeholder="جستجو در دسته‌ها..." style="width:250px; margin-left:10px;" />
        <button type="submit" class="btn btn-primary">🔍 جستجو</button>
        <a href="/Administrator/Categories/Index" class="btn btn-default">نمایش همه</a>
    </form>
</div>

<div class="ibox-content table-responsive">
    <table class="table table-bordered table-hover table-striped">
        <thead>
            <tr>
                <th>آیکون دسته</th>
                <th>نام دسته پدر</th>
                <th>نام فارسی دسته</th>
                <th>نام لاتین دسته</th>
                <th>تعداد محصولات</th>
                <th>عملیات</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.data)
            {
                <tr>
                    <td>
                        <i style="font-size:24px;" class="fa fa-@item.Icon"></i>
                    </td>
                    <td>
                        @(item.Parent != null ? item.Parent.PersianName : "— دسته اصلی —")
                    </td>
                    <td>@item.PersianName</td>
                    <td>@item.EnglishName</td>
                    <td class="text-center">@((item.Products?.Count() ?? 0))</td>
                    <td>
                        @Html.ActionLink("ویرایش", "Edit", new { id = item.Id }, new { @class = "btn btn-warning btn-xs" })
                        @Html.ActionLink("جزئیات", "Details", new { id = item.Id }, new { @class = "btn btn-info btn-xs" })
                        @Html.ActionLink("حذف", "Delete", new { id = item.Id }, new { @class = "btn btn-danger btn-xs" })
                    </td>
                </tr>
            }
        </tbody>
    </table>
    <div class="row">
        <div class="col-md-6" style="direction:ltr">
            <ul class="pagination pagination-sm">
                <li>
                    @Html.Pager(
                        pageSize: 10,
                        currentPage: Model.CurrentPage,
                        totalItemCount: Model.TotalItemCount,
                        values: new { search = Request["search"] }  // 👈 این مهمه
                    )
                </li>
            </ul>
        </div>
    </div>
</div>
