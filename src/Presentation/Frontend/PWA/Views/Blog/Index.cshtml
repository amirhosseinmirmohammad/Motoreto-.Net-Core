@model Domain.Blog
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = Model.Title + " | موتورتو";
}
@{
    Infrastructure.ApplicationDbContext db = new Infrastructure.ApplicationDbContext();
}
@using System.Data.Entity;
@using System.Linq;
@using Microsoft.AspNet.Identity;
@using System.Web.Mvc;
@using System.Data.Entity;
@using Domain;
@section Metas {
    <meta name="description" content="@Model.MetaDesc">
    <meta name="Keywords" content="@Model.MetaKey">
    <meta property="og:title" content="موتورتو | @Model.Title" />
    <meta property="og:url" content="@Request.Url.AbsoluteUri" />
    @if (Model.Images.Count() > 0)
    {
        <meta property="og:image" content="@string.Format("{0}{1}", "http://motoreto.ir", Model.Images.FirstOrDefault().FullPath)" />
        <meta name="twitter:image" content="@string.Format("{0}{1}", "http://motoreto.ir", Model.Images.FirstOrDefault().FullPath)" />
    }
    else
    {
        <meta property="og:image" content="http://motoreto.ir/images/sadr_logo.png" />
        <meta name="twitter:image" content="http://motoreto.ir/images/sadr_logo.png">
    }

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="موتورتو | @Model.Title">
    <meta name="twitter:description" content="@Model.MetaDesc">
    <link rel="canonical" href="@Url.Action("Details","Blog", new { id = Model.Id, sefUrl = Model.SefUrl }, Request.Url.Scheme)" />
    <meta property="article:tag" content="@Model.Title" />
    <meta property="article:published_time" content="@Shared.Helpers.FunctionsHelper.GetPersianDateTime((DateTime)Model.CreateDate, true, true)" />
    <meta property="article:section" content="@Model.Category.PersianName" />
}

@section Styles{
    <style>
        ul {
            direction: rtl;
            line-height: 30px;
        }

        .thumbnail {
            padding: 0px;
        }

        .panel {
            position: relative;
        }

            .panel > .panel-heading:after, .panel > .panel-heading:before {
                position: absolute;
                top: 11px;
                left: -16px;
                right: 100%;
                width: 0;
                height: 0;
                display: block;
                content: " ";
                border-color: transparent;
                border-style: solid solid outset;
                pointer-events: none;
            }

            .panel > .panel-heading:after {
                border-width: 7px;
                border-right-color: #f7f7f7;
                margin-top: 1px;
                margin-left: 2px;
            }

            .panel > .panel-heading:before {
                border-right-color: #ddd;
                border-width: 8px;
            }

        .card {
            min-height: initial !important
        }
    </style>
    @{
        var url = "motoreto.ir";
        var body = Html.Raw(Model.Body);
        var body2 = Html.Raw(Model.Body);
        <link href="~/css/blog.css rel="stylesheet" />
    }
    @{
        var hasImage = Model.Images.Any();
        var absUrl = Url.Action("Details", "Blog", new { id = Model.Id, sefUrl = Model.SefUrl }, Request.Url.Scheme);
        var imgUrl = hasImage ? $"{Request.Url.Scheme}://{Request.Url.Host}{Model.Images.First().FullPath}" : "https://motoreto.ir/images/sadr_logo.png";
        var iso = Model.CreateDate?.ToString("yyyy-MM-ddTHH:mm:ssK") ?? "";
        var wordCount = (Model.Body ?? "").Split(new[] { ' ', '\n', '\r', '\t' }, StringSplitOptions.RemoveEmptyEntries).Length;
    }
    <script type="application/ld+json">
{
  "@@context": "https://schema.org",
  "@@type": "BlogPosting",
  "mainEntityOfPage": "@absUrl",
  "headline": "@Model.Title",
  "image": "@imgUrl",
  "author": { "@@type": "Person", "name": "موتورتو" },
  "publisher": {
    "@@type": "Organization",
    "name": "موتورتو",
    "logo": { "@@type": "ImageObject", "url": "https://motoreto.ir/images/sadr_logo.png" }
  },
  "inLanguage": "fa-IR",
  "wordcount": "@wordCount",
  "articleSection": "@Model.Category.PersianName",
  "datePublished": "@iso",
  "dateModified": "@iso",
  "description": "@Model.MetaDesc"
}
    </script>

    <script type="application/ld+json">
{
  "@@context": "https://schema.org",
  "@@type": "BreadcrumbList",
  "itemListElement": [
    { "@@type": "ListItem", "position": 1,
      "item": { "@@id": "https://motoreto.ir", "name": "موتورتو" } },
    { "@@type": "ListItem", "position": 2,
      "item": { "@@id": "@absUrl", "name": "@Model.Title" } }
  ]
}
    </script>
}

<!-- single -->
<section class="bottom-banner-w3layouts">
    <div class="container">
        <h2 class="heading text-center" title="@Model.Title">@Model.Title </h2>
        @if (TempData["Error"] != null)
        {
            <div class="container text-center" style="direction:rtl !important;">
                <div class="wrapper wrapper-content animated fadeIn">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <div class="ibox-content">
                                        <div class="alert alert-danger">
                                            @TempData["Error"]
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }

        @if (TempData["Success"] != null)
        {
            <div class="container text-center" style="direction:rtl !important;">
                <div class="wrapper wrapper-content animated fadeIn">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="ibox float-e-margins">
                                <div class="ibox-title">
                                    <div class="ibox-content">
                                        <div class="alert alert-success">
                                            @TempData["Success"]
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
        <div class="row inner-sec-w3ls-agileinfo">
            <!--left-->
            <div class="col-lg-8 left-blog-info text-left pull-right">
                <div class="card">
                    <a href="">
                        @if (Model.Images.Count() > 0)
                        {
                            <img src="@Model.Images.FirstOrDefault().FullPath" class="card-img-top img-fluid" alt="@Model.Title" title="@Model.Title">
                        }
                    </a>
                    <div class="card-body">
                        <ul class="blog-icons my-4">
                            <li>
                                <a href="#">
                                    <span class="fa fa-calendar"></span> @Shared.Helpers.FunctionsHelper.GetPersianDateTime((DateTime)Model.CreateDate, false, false)
                                </a>
                            </li>
                            <li class="mx-2">
                                <a href="#">
                                    <span class="fa fa-comment"></span> @Model.BlogComments.Count
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <span class="fa fa-eye"></span> @Model.Survey
                                </a>
                            </li>

                        </ul>
                        <h1 class="card-title" title="@Model.Title">
                            @Model.Title
                        </h1>
                        <div class="body-blog">
                            @Html.Raw(Model.Body)
                        </div>
                    </div>
                </div>
                @if (Model.BlogComments.Where(current => current.IsApprove == true).Count() > 0)
                {
                    <div class="comment-top" style="direction:rtl !important;text-align:right !important;">
                        <h4>نظرات</h4>
                        @foreach (var item in Model.BlogComments.Where(current => current.IsApprove == true).ToList())
                        {
                            <div class="media">
                                <img src="~/images/user_chat.png" alt="کاربر موتورتو" title="کاربر موتورتو" class="img-fluid rounded comment-user">
                                <div class="media-body" style="margin-right:20px !important;">
                                    <h5 class="mt-sm-0 mt-3">@item.FullName</h5>
                                    <p>
                                        @item.Text
                                    </p>
                                </div>
                            </div>
                        }
                    </div>
                }
                <div class="comment-top">
                    <h4>دیدگاه خود را بیان کنید</h4>
                    <div class="comment-bottom">
                        <form method="post" action="/Blog/SubmitComment">
                            @Html.AntiForgeryToken()
                            <input class="form-control" type="text" name="FullName" placeholder="نام و نام خانوادگی" required>
                            <textarea class="form-control" name="Text" placeholder="نظر شما . . ." requireds></textarea>
                            <input type="hidden" value="@Model.Id" name="BlogId" />
                            <button type="submit" class="btn btn-primary submit">ثبت</button>
                        </form>
                    </div>
                </div>

            </div>
            <!--//left-->
            <!--right-->
            <aside class="col-lg-4 right-blog-con text-left pull-right">
                <div class="right-blog-info text-left">
                    <div class="tech-btm">
                    </div>
                    <div class="tech-btm">
                        <h4>عضویت در خبرنامه</h4>
                        <p>با عضویت در خبرنامه تازه ترین های موتورتو را دریافت کنید</p>
                        <form action="#" method="post">
                            <input id="textnews" class="form-control" type="email" placeholder="example@gmail.com" required>
                            <input id="btntext" class="form-control" type="submit" value="ثبت">
                        </form>
                        <div class="text-center">
                            <h6 class="newsletter"><b id="msg"></b></h6>
                        </div>
                    </div>

                    <div class="tech-btm">
                        <h4>مطالب پربازدید</h4>
                        @foreach (var item in db.Blogs.Where(current => current.IsVisible == true && current.CategoryId == Model.CategoryId).OrderByDescending(current => current.Survey).Include(current => current.Images).Take(2))
                        {
                            <div class="blog-grids row mb-3">
                                <div class="col-md-5 blog-grid-left">
                                    <a title="@item.Title" href="/blog/@item.Id/@item.SefUrl">
                                        @if (item.Images.Count() > 0)
                                        {
                                            <img src="@item.Images.FirstOrDefault().FullPath" class="card-img-top img-fluid" alt="@Model.Title" title="@Model.Title">
                                        }
                                    </a>
                                </div>
                                <div class="col-md-7 blog-grid-right">
                                    <h5>
                                        <a title="@item.Title" href="/blog/@item.Id/@item.SefUrl">@item.Title </a>
                                    </h5>
                                    <div class="sub-meta">
                                        <span>
                                            <span class="fa fa-clock-o"></span> @Shared.Helpers.FunctionsHelper.GetPersianDateTime((DateTime)item.CreateDate, false, false)
                                        </span>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                    <div class="tech-btm widget_social text-center">
                        <h4>موتورتو در شبکه های اجتماعی</h4>
                        <ul>
                            <li>
                                <a rel="noopener noreferrer nofollow" target="_blank" class="twitter" href="#">
                                    <span class="count">توئیتر</span>
                                </a>
                            </li>
                            <li>
                                <a rel="noopener noreferrer nofollow" target="_blank" class="facebook" href="#">
                                    <span class="count">فیس بوک</span>
                                </a>
                            </li>
                            <li>
                                <a rel="noopener noreferrer nofollow" target="_blank" class="instagram" href="https://www.instagram.com/motoreto.ir">
                                    <span class="count">اینستاگرام</span>
                                </a>
                            </li>
                            <li>
                                <a rel="noopener noreferrer nofollow" target="_blank" class="telegram" href="https://telegram.me/motoreto.ir">
                                    <span class="count">تلگرام</span>
                                </a>
                            </li>
                            <li>
                                <a rel="noopener noreferrer nofollow" target="_blank" class="youtube" href="#">
                                    <span class="count">یوتیوب</span>
                                </a>
                            </li>
                            <li>
                                <a rel="noopener noreferrer nofollow" target="_blank" class="linkedin-in" href="#">
                                    <span class="count">لینکدین</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </aside>
            <!--//right-->
        </div>
    </div>
</section>
<!-- //contact -->

@section Scripts{

}



